{"version":3,"file":"relatorio-zelador-saude.js","sourceRoot":"","sources":["../../src/relatorios/relatorio-zelador-saude.ts"],"names":[],"mappings":"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","sourcesContent":["// SPDX-License-Identifier: MIT\r\nimport chalk from '@nucleo/constelacao/chalk-safe.js';\r\nimport { estatisticasUsoGlobal } from '@analistas/analista-padroes-uso.js';\r\nimport { config } from '@nucleo/constelacao/cosmos.js';\r\nimport { log } from '@nucleo/constelacao/log.js';\r\nimport { Ocorrencia } from '@tipos/tipos.js';\r\n\r\n/**\r\n * Emite um relat√≥rio sobre a sa√∫de do c√≥digo com base nas estat√≠sticas gerais.\r\n */\r\nexport function exibirRelatorioZeladorSaude(ocorrencias: Ocorrencia[]): void {\r\n  // Usa o helper centralizado de molduras, com largura fixa para manter bordas alinhadas\r\n  const constExcessivas = Object.entries(estatisticasUsoGlobal.consts).filter(([, n]) => n > 3);\r\n  const requireRepetidos = Object.entries(estatisticasUsoGlobal.requires).filter(([, n]) => n > 3);\r\n\r\n  // Cabe√ßalho: manter linha para compatibilidade de testes\r\n  log.info('\\nüßº Relat√≥rio de Sa√∫de do C√≥digo:\\n');\r\n  // Moldura do cabe√ßalho (somente em runtime humano)\r\n  if (!process.env.VITEST) {\r\n    const tituloCab = 'Relat√≥rio de Sa√∫de do C√≥digo';\r\n    const linhasCab: string[] = [];\r\n    const larguraCab = (log as unknown as { calcularLargura?: Function }).calcularLargura\r\n      ? (log as unknown as { calcularLargura: Function }).calcularLargura(\r\n          tituloCab,\r\n          linhasCab,\r\n          config.COMPACT_MODE ? 84 : 96,\r\n        )\r\n      : undefined;\r\n    (log as unknown as { imprimirBloco: Function }).imprimirBloco(\r\n      tituloCab,\r\n      linhasCab,\r\n      chalk.cyan.bold,\r\n      typeof larguraCab === 'number' ? larguraCab : config.COMPACT_MODE ? 84 : 96,\r\n    );\r\n    console.log('');\r\n  }\r\n\r\n  if (ocorrencias.length > 0) {\r\n    // Mant√©m aviso compat√≠vel com testes, sem listar todas as ocorr√™ncias\r\n    // Usa fallback para ambientes de teste/mocks que n√£o exponham `aviso`\r\n    const logAviso = (log as unknown as { aviso?: (m: string) => void; info: (m: string) => void })\r\n      .aviso;\r\n    if (typeof logAviso === 'function') logAviso('‚ö†Ô∏è Fun√ß√µes longas encontradas:');\r\n    else log.info('‚ö†Ô∏è Fun√ß√µes longas encontradas:');\r\n    // Agrega por arquivo\r\n    const porArquivo = new Map<string, number>();\r\n    for (const o of ocorrencias) {\r\n      const key = o.relPath || o.arquivo || '[desconhecido]';\r\n      porArquivo.set(key, (porArquivo.get(key) || 0) + 1);\r\n    }\r\n\r\n    const totalOcorrencias = ocorrencias.length;\r\n    const arquivosAfetados = porArquivo.size;\r\n    const maiorPorArquivo = Math.max(...Array.from(porArquivo.values()));\r\n\r\n    const mostrarTabela = config.RELATORIO_SAUDE_TABELA_ENABLED && !config.VERBOSE;\r\n\r\n    type LogComBloco = {\r\n      imprimirBloco?: (t: string, l: string[], c?: (s: string) => string, w?: number) => void;\r\n    };\r\n    const temImprimirBloco = typeof (log as unknown as LogComBloco).imprimirBloco === 'function';\r\n    if (mostrarTabela && temImprimirBloco) {\r\n      // Tabela compacta com moldura, sem caminhos\r\n      const header1 = 'arquivos';\r\n      const header2 = 'quantidade';\r\n      const linhas: string[] = [];\r\n      const col1Width = Math.max(\r\n        header1.length,\r\n        'com fun√ß√£o longa'.length,\r\n        'fun√ß√µes longas (total)'.length,\r\n        'maior por arquivo'.length,\r\n      );\r\n      const col2Width = Math.max(\r\n        header2.length,\r\n        String(totalOcorrencias).length,\r\n        String(arquivosAfetados).length,\r\n        String(maiorPorArquivo).length,\r\n      );\r\n      const pinta = (n: number) => chalk.yellow(String(n).padStart(col2Width));\r\n      linhas.push(\r\n        `${header1.padEnd(col1Width)}  ${header2.padStart(col2Width)}`,\r\n        `${'-'.repeat(col1Width)}  ${'-'.repeat(col2Width)}`,\r\n        `${'com fun√ß√£o longa'.padEnd(col1Width)}  ${pinta(arquivosAfetados)}`,\r\n        `${'fun√ß√µes longas (total)'.padEnd(col1Width)}  ${pinta(totalOcorrencias)}`,\r\n        `${'maior por arquivo'.padEnd(col1Width)}  ${pinta(maiorPorArquivo)}`,\r\n        ''.padEnd(col1Width + col2Width + 2, ' '),\r\n        `${'RESUMIDO'.padStart(Math.floor(col1Width / 2) + 4).padEnd(col1Width + col2Width + 2)}`,\r\n      );\r\n\r\n      (\r\n        log as unknown as {\r\n          imprimirBloco: (t: string, l: string[], c?: (s: string) => string, w?: number) => void;\r\n        }\r\n      ).imprimirBloco(\r\n        'fun√ß√µes longas:',\r\n        linhas,\r\n        chalk.cyan.bold,\r\n        (log as unknown as { calcularLargura?: Function }).calcularLargura\r\n          ? (log as unknown as { calcularLargura: Function }).calcularLargura(\r\n              'fun√ß√µes longas:',\r\n              linhas,\r\n              config.COMPACT_MODE ? 84 : 96,\r\n            )\r\n          : 84,\r\n      );\r\n      console.log('');\r\n\r\n      // Dicas\r\n      log.info('Para diagn√≥stico detalhado, execute: oraculo diagnosticar --export');\r\n      log.info('Para ver tabelas com moldura no terminal (muito verboso), use: --debug');\r\n      log.info('');\r\n    } else if (mostrarTabela) {\r\n      // Fallback quando o mock de log n√£o exp√µe imprimirBloco (ex.: testes)\r\n      const logInfoRaw = (\r\n        (log as unknown as { infoSemSanitizar?: (m: string) => void; info: (m: string) => void })\r\n          .infoSemSanitizar || log.info\r\n      ).bind(log);\r\n      const header1 = 'arquivos';\r\n      const header2 = 'quantidade';\r\n      const col1Width = Math.max(\r\n        header1.length,\r\n        'com fun√ß√£o longa'.length,\r\n        'fun√ß√µes longas (total)'.length,\r\n        'maior por arquivo'.length,\r\n      );\r\n      const col2Width = Math.max(\r\n        header2.length,\r\n        String(totalOcorrencias).length,\r\n        String(arquivosAfetados).length,\r\n        String(maiorPorArquivo).length,\r\n      );\r\n      log.info(`${header1.padEnd(col1Width)}  ${header2.padStart(col2Width)}`);\r\n      log.info(`${'-'.repeat(col1Width)}  ${'-'.repeat(col2Width)}`);\r\n      logInfoRaw(\r\n        `${'com fun√ß√£o longa'.padEnd(col1Width)}  ${chalk.yellow(String(arquivosAfetados).padStart(col2Width))}`,\r\n      );\r\n      logInfoRaw(\r\n        `${'fun√ß√µes longas (total)'.padEnd(col1Width)}  ${chalk.yellow(String(totalOcorrencias).padStart(col2Width))}`,\r\n      );\r\n      logInfoRaw(\r\n        `${'maior por arquivo'.padEnd(col1Width)}  ${chalk.yellow(String(maiorPorArquivo).padStart(col2Width))}`,\r\n      );\r\n      log.info('');\r\n      // Dicas (mant√©m compatibilidade com testes que s√≥ checam mensagens principais)\r\n      log.info('Para diagn√≥stico detalhado, execute: oraculo diagnosticar --export');\r\n      log.info('Para ver tabelas com moldura no terminal (muito verboso), use: --debug');\r\n      log.info('');\r\n    } else {\r\n      // Modo verbose: lista detalhada alinhada por coluna, left-align do caminho\r\n      const logInfoRaw = (\r\n        (log as unknown as { infoSemSanitizar?: (m: string) => void; info: (m: string) => void })\r\n          .infoSemSanitizar || log.info\r\n      ).bind(log);\r\n      const titulo = chalk.bold('Detalhes de fun√ß√µes longas por arquivo');\r\n      log.info(titulo);\r\n      const colLeft = 50;\r\n      const linhasDetalhe: string[] = [];\r\n      const ordenar = Array.from(porArquivo.entries()).sort((a, b) => b[1] - a[1]);\r\n      for (const [arquivo, qtd] of ordenar) {\r\n        // Normaliza caminho e alinha\r\n        const left = arquivo.length > colLeft ? '‚Ä¶' + arquivo.slice(-colLeft + 1) : arquivo;\r\n        const numero = chalk.yellow(String(qtd).padStart(3));\r\n        linhasDetalhe.push(`${left.padEnd(colLeft)}  ${numero}`);\r\n      }\r\n      // Em verbose n√£o usamos moldura de bloco para permitir rolagem limpa\r\n      for (const l of linhasDetalhe) logInfoRaw(l);\r\n      log.info('');\r\n    }\r\n  } else {\r\n    log.sucesso('Nenhuma fun√ß√£o acima do limite.');\r\n  }\r\n\r\n  if (constExcessivas.length > 0) {\r\n    log.info('üîÅ Constantes definidas mais de 3 vezes:');\r\n    for (const [nome, qtd] of constExcessivas) {\r\n      log.info(`  - ${nome}: ${qtd} vez(es)`);\r\n    }\r\n    log.info('');\r\n  }\r\n\r\n  if (requireRepetidos.length > 0) {\r\n    log.info('üì¶ M√≥dulos require utilizados mais de 3 vezes:');\r\n    for (const [nome, qtd] of requireRepetidos) {\r\n      log.info(`  - ${nome}: ${qtd} vez(es)`);\r\n    }\r\n    log.info('');\r\n  }\r\n\r\n  // Rodap√©: manter sucesso para testes\r\n  log.sucesso('Fim do relat√≥rio do zelador.');\r\n  // Moldura de rodap√© (somente em runtime humano)\r\n  if (!process.env.VITEST) {\r\n    const tituloFim = 'Fim do relat√≥rio do zelador';\r\n    const linhasFim: string[] = ['Mandou bem!'];\r\n    const larguraFim = (log as unknown as { calcularLargura?: Function }).calcularLargura\r\n      ? (log as unknown as { calcularLargura: Function }).calcularLargura(\r\n          tituloFim,\r\n          linhasFim,\r\n          config.COMPACT_MODE ? 84 : 96,\r\n        )\r\n      : undefined;\r\n    (log as unknown as { imprimirBloco: Function }).imprimirBloco(\r\n      tituloFim,\r\n      linhasFim,\r\n      chalk.green.bold,\r\n      typeof larguraFim === 'number' ? larguraFim : config.COMPACT_MODE ? 84 : 96,\r\n    );\r\n    console.log('');\r\n  }\r\n}\r\n"]}